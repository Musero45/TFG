
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Helicopter missions</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-03-31"><meta name="DC.source" content="demoHelicopterMissions.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h1>Helicopter missions</h1><!--introduction--><p>This demo shows the usage of mission module to help in the construction of helicopters missions.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Introduction</a></li><li><a href="#2">Description of usage</a></li><li><a href="#12">Example of a simple mission type: Civil Surveillance Mission</a></li><li><a href="#24">Example of a complex mission type: Civil Firefighting Mission</a></li></ul></div><h2>Introduction<a name="1"></a></h2><p>The term <i><b>mission</b></i> refers to the intended use of the aircraft and determines its design since it specifies what is required in the usage of the helicopter. These requirements are used in the design chain to evaluate the quality and need to be studied in order to check if a helicopter is able to carry out what is entrusted.</p><p>Mission is a set of flight segments that need to be executed under agreed conditions. The choice of flight variables included in these segments must be consistent with what the mission requires and therefore being able to calculate all that is needed. A mission involves burning fuel during its performance, so it is necessary to consider modifying the mass conditions along it.</p><p>To verify the performance of a task by a helicopter, it is required to develop the tools to configure this mission. To do this, it will proceed first by defining the elements forming a mission.</p><pre class="codeinput">close <span class="string">all</span>
setPlot
</pre><h2>Description of usage<a name="2"></a></h2><p>The example chosen to assist the usage of this module, mission, is that of a simple mission formed by a pair of segments. It is displayed below:</p><p>First we always have to set up heroes environment by defining an ISA+0 atmosphere and a Eurocopter EC135 helicopter. The variable <i><b>atm</b></i> stores the atmosphere, <i><b>he</b></i> stores the helicopter and <i><b>OmegaN</b></i> saves  the main rotor angular speed of the helicopter setup.</p><pre class="codeinput">atm    = getISA;
he     = ec135e(atm);
OmegaN = he.mainRotor.Omega;
</pre><p>Then, the payload, the initial fuel mass and the fuel reserve are set up. It is important to remember that the payload dimensions are <i>[N]</i>, and the dimensions of fuel mass and fuel reserve are <i>[Kg]</i>.</p><p>The Reserve of fuel must be set according to the regulations: In the case of VFR operations, the regulations establish that the fuel reserves should be enough to fly for 20 minutes at maximum speed range. While in the case of IFR, fuel reserve must be sufficient to fly for 30 minutes at hover speed at 450 m (1500 ft) above the aerodrome of destination.</p><pre class="codeinput">PL0 = 150*atm.g;
Mf0 = 100;
RF  = 65;
</pre><p>Once the mission requirements have been loaded, it is necessary to define the type of mission to be performed by the selected helicopter, in this case the Eurocopter EC135. Each segment needs several inputs, being the first, last and penultimate entries common for all segment builders. These three inputs correspond respectively to the segment position, the main rotor angular speed and payload variation of the flight segment. The other inputs are different for each segment and match with for example, the hight variation of the flight segment, ascent or descent angle, the time increment of the flight segment and other variables. The help of each segment builder explains all the inputs needed for this segment.</p><pre class="codeinput">mission = {@(pos)TaxiSegmentBuilder(pos,120,4,0,OmegaN),<span class="keyword">...</span>
           @(pos)ClimbSegmentBuilder(pos,580,36,5*pi/180,0,OmegaN)};
</pre><p>A list of all possible segments, as well as all the requested help for building helicopter missions can be found by typing on cosole:</p><pre>     &gt;&gt; help mission</pre><p>Next step, after defining the required mission, is to solve the whole mission using <i><b>getMissionState</b></i>. This function saves the results of the mission in two variables, <i><b>MfBurnt</b></i> and <i><b>missState</b></i>.</p><div><ul><li><i><b>MfBurnt</b></i> stores the fuel mass consumed during the mission, which has been obtained with the given initial parameters.</li></ul></div><div><ul><li><i><b>missState</b></i> saves the mission segments parameters.</li></ul></div><p>The help of this function explains how these variables are, which the saved parameters are and how to use the function.</p><p>In order to calculate the mission, this function includes a dummy hover segment which is common for all the missions. That is why, in <i><b>missState</b></i> this dummy hover segment is the first saved and then saves the rest of them. So the final number of segments is, in this case, three.</p><pre class="codeinput">[MfBurnt,missState] = getMissionState(he,atm,mission,PL0,Mf0,RF);
</pre><p>Finally, this module aims to optimize the fuel mass that the helicopter should carry to complete the mission without problems and with zero fuel mass at the end. This optimization is carried out with the function <i><b>getOptimumFuelMass</b></i> and the optimum initial fuel mass obtained is kept in the variable <i><b>Mf0opt</b></i>.</p><pre class="codeinput">Mf0opt = getOptimumFuelMass(he,atm,mission,PL0,Mf0,RF);
</pre><p>After obtaining the results of the mission, it is useful plotting these results to see what is the mission state and to check if it was successful.</p><p>The most representative plot of the mission route is the hight versus the range.</p><pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);

     figure (100)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.H,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'H [m]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_01.png" alt=""> <p>Another representative plot of the mission parameters is the fuel mass variation and the payload variation with range and time</p><pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);

     figure (102)

     subplot(2,2,1)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.Mf,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'Mf [kg]'</span>);

     subplot(2,2,2)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.Mf,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'Mf [kg]'</span>);

     subplot(2,2,3)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.PL,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'PL [N]'</span>);

     subplot(2,2,4)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.PL,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'PL [N]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_02.png" alt=""> <p>At the end, other important plots could be the following:</p><pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);

     figure (103)

     subplot(2,2,1)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.V,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'V [m/s]'</span>);

     subplot(2,2,2)
     grid <span class="string">on</span>
     x = missState.mSeg{s}.T;
     y = missState.mSeg{s}.R;
     plot(x,y,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     ylabel(<span class="string">'R [m]'</span>);
     xlabel(<span class="string">'T [s]'</span>);

     subplot(2,2,3)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.H,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'H [m]'</span>);

     subplot(2,2,4)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.P/10^3,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'P [kW]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_03.png" alt=""> <h2>Example of a simple mission type: Civil Surveillance Mission<a name="12"></a></h2><p>One of the easiest helicopter missions is the <b>Civil Surveillance</b> <b>Mission</b>. This mission type has seven segments, without counting the dummy segment, in which a cruise speed of maximum endurance is included. The reason of this type of cruise segment is that the aim of the mission consists on surveilling an area for the maximum, possible time. After this cruise, there is a hover flight segment to focuse on the main area of the surveillance.</p><p>First we setup heroes environment by defining an ISA+0 atmosphere and a Eurocopter EC135 helicopter. The variable <i><b>atm</b></i> stores the atmosphere, <i><b>he</b></i> stores the helicopter and <i><b>OmegaN</b></i> saves the main rotor angular speed.</p><pre class="codeinput">atm    = getISA;
he     = ec135e(atm);
OmegaN = he.mainRotor.Omega;
</pre><p>Then the payload, the initial fuel mass and the fuel reserve are setup. Remember that the payload dimensions are <i>[N]</i>, and the dimensions of fuel mass and reserve of fuel are <i>[Kg]</i>.</p><pre class="codeinput">PL0 = 150*atm.g;
Mf0 = 120;
RF  = 65;
</pre><p>In this type of mission the payload variation is zero, all necessary payload is set up at the begining of the mission and it is not variable through the mission.</p><p>Now, we have to define the mission segments:</p><p>First, there is a <i><b>HOVER</b></i> segment which will be defined by the time increment, DT, and like all segments, by payload variation and the main rotor angular speed. The second is a <i><b>TAXI</b></i> segment, it is defined by time increment, DT, and flight velocity, DV. For defining the third segment, <i><b>CLIMB</b></i>, we have as inputs hight increment,DH, the flight velocity, DV, and the ascent angle, gammaT. The fourth segment is a <i><b>CRUISE</b></i>, which is defined only by time increment, DT, because this segment is calculated with the maximum endurance velocity. The fifth mission segment is a <i><b>HOVER</b></i>, defined as in the previous case. Finally, the mission has a <i><b>DESCENT</b></i> segment defined as a climb segment but with negative angle and negative hight increment, and a <i><b>TAXI</b></i> segment defined as in the previous case.</p><pre class="codeinput">mission = {@(pos)HoverSegmentBuilder(pos,60,0,OmegaN),<span class="keyword">...</span>
           @(pos)TaxiSegmentBuilder(pos,90,4,0,OmegaN),<span class="keyword">...</span>
           @(pos)ClimbSegmentBuilder(pos,650,30,15*pi/180,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseTimeSegmentBuilder(pos,3600,0,OmegaN),<span class="keyword">...</span>
           @(pos)HoverSegmentBuilder(pos,180,0,OmegaN),<span class="keyword">...</span>
           @(pos)DescentSegmentBuilder(pos,-650,30,-15*pi/180,0,OmegaN),<span class="keyword">...</span>
           @(pos)TaxiSegmentBuilder(pos,90,4,0,OmegaN)};
</pre><p>Remember that a list of all possible segments, as well as all the requested help for building helicopter missions can be found by typing on cosole:</p><pre>     &gt;&gt; help mission</pre><p>In this moment we are ready to solve the mission:</p><pre class="codeinput">[MfBurnt,missState] = getMissionState(he,atm,mission,PL0,Mf0,RF);

disp(<span class="string">'Civil Surveillance Mission'</span>)
formatSpec = <span class="string">'The consumed fuel mass is %d.'</span>;
A    = MfBurnt;
MfB1 = sprintf(formatSpec,A);
disp(MfB1);
</pre><pre class="codeoutput">Civil Surveillance Mission
The consumed fuel mass is 1.058003e+02.
</pre><p>Once the fuel mass consumption and mission state are obtained, we can optimize the initial fuel mass to carry out the mission without problem, with the minimum initial fuel masss possible.</p><pre class="codeinput">Mf0opt = getOptimumFuelMass(he,atm,mission,PL0,Mf0,RF);

formatSpec = <span class="string">'The optimum fuel mass is %d.'</span>;
B    = Mf0opt;
MfO1 = sprintf(formatSpec,B);
disp(MfO1);
</pre><pre class="codeoutput">The optimum fuel mass is 1.052107e+02.
</pre><p>Sometimes it may also be useful to print some mission data. For example the total mission time or the range the climb segment takes.</p><pre class="codeinput">formatSpec = <span class="string">'The total mission time is %d.'</span>;
C  = missState.mSeg{8}.T(2);
C1 = sprintf(formatSpec,C);
disp(C1);

formatSpec = <span class="string">'The range the climb segment takes is %d.'</span>;
D  = missState.mSeg{4}.DR;
D1 = sprintf(formatSpec,D);
disp(D1);
</pre><pre class="codeoutput">The total mission time is 4.188427e+03.
The range the climb segment takes is 2.425833e+03.
</pre><p>Finally we can plot some mission parameters to see the mission final state.</p><pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);

     figure (104)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.H,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'H [m]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_04.png" alt=""> <pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);
     figure (105)

     subplot(2,2,1)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.Mf,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'Mf [kg]'</span>);

     subplot(2,2,2)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.Mf,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'Mf [kg]'</span>);

     subplot(2,2,3)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.PL,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'PL [N]'</span>);

     subplot(2,2,4)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.PL,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'PL [N]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_05.png" alt=""> <pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);
     figure (106)

     subplot(2,2,1)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.V,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'V [m/s]'</span>);

     subplot(2,2,2)
     grid <span class="string">on</span>
     x = missState.mSeg{s}.T;
     y = missState.mSeg{s}.R;
     plot(x,y,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     ylabel(<span class="string">'R [m]'</span>);
     xlabel(<span class="string">'T [s]'</span>);

     subplot(2,2,3)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.H,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'H [m]'</span>);

     subplot(2,2,4)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.P/10^3,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'P [kW]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_06.png" alt=""> <h2>Example of a complex mission type: Civil Firefighting Mission<a name="24"></a></h2><p>In firefighting mission,it is difficult to define the segments compounding this mission because the refill segments for the complete extinction of fire are not defined. The time a helicopter can be extinguishing a fire is regulated, and usually it is set to two hours. So there are two possible ways to set the refill and extinction mission segments.</p><div><ul><li>Fixing a number of segments</li></ul></div><div><ul><li>Fixing the maximum time of extinction</li></ul></div><p><b>Fixing number of segments:</b></p><p>In this case, the number of water refills must be fixed at first. Since the extinction time is limited for two hours, once the mission is calculated you should check if this constraint is satisfied by the number of segments that had been planned for the mission.</p><p>Example of usage:</p><p>First we setup heroes environment, a helicopter and the initial payload and fuel mass and the fuel reserve:</p><pre class="codeinput">atm    = getISA;
he     = ec135e(atm);
OmegaN = he.mainRotor.Omega;

PL0 = 150*atm.g;
Mf0 = 130;
RF  = 65;
</pre><p>Setting the mission segments.</p><p><b>Refills number: 1</b> Segments involved in the extinction of fire must be repeated as much times as refills number.</p><p>The segments involved in the filling and discharge of water for the extinction are:</p><p><b>DescentSegment</b>     for approaching the sea, lake or dam. <b>HoverSegment</b>       for refilling water. <b>ClimbSegment</b>       for ascending at flight hight. <b>CruiseRangeSegment</b> for reaching the fire area. <b>DescentSegment</b>     for approaching the fire area. <b>CruiseRangeCruise</b>  for discharging the water. <b>ClimbSegment</b>       for ascending at flight hight. <b>CruiseRangeSegment</b> for returning to the sea, lake or dam.</p><p>In such a mission, payload variation must be considered due to the charge and discharge of water.</p><pre class="codeinput">mission = {<span class="keyword">...</span><span class="comment"> Route heliport - area of water</span>
           @(pos)HoverSegmentBuilder(pos,60,0,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,300,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,4*10^4,0,OmegaN),<span class="keyword">...</span>
           <span class="keyword">...</span><span class="comment"> 1 refill and discharge of water</span>
           @(pos)BestGlideSegmentBuilder(pos,-280,0,OmegaN),<span class="keyword">...</span>
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,280,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestGlideSegmentBuilder(pos,-200,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),<span class="keyword">...</span>
           <span class="keyword">...</span><span class="comment"> Back to the heliport</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,380,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,71*10^3,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestGlideSegmentBuilder(pos,-480,0,OmegaN),<span class="keyword">...</span>
           @(pos)TaxiSegmentBuilder(pos,72,4,0,OmegaN)};
</pre><p>Remember that a list of all possible segments, as well as all the requested help for building helicopter missions can be found by typing on cosole:</p><pre>     &gt;&gt; help mission</pre><p>Solving the mission and optimizing initial fuel mass:</p><pre class="codeinput">[MfBurnt,missState] = getMissionState(he,atm,mission,PL0,Mf0,RF);

disp(<span class="string">'Civil Firefighting Mission'</span>)
formatSpec = <span class="string">'The consumed fuel mass is %d.'</span>;
E    = MfBurnt;
MfB2 = sprintf(formatSpec,E);
disp(MfB2);


Mf0opt = getOptimumFuelMass(he,atm,mission,PL0,Mf0,RF);

formatSpec = <span class="string">'The optimum fuel mass is %d.'</span>;
F    = Mf0opt;
MfO2 = sprintf(formatSpec,F);
disp(MfO2);
</pre><pre class="codeoutput">
Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.
Civil Firefighting Mission
The consumed fuel mass is 9.560407e+01.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1
The optimum fuel mass is 9.495447e+01.
</pre><p>Finally some plots to see the final state of the mission.</p><pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);

     figure (107)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.H,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'H [m]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_07.png" alt=""> <pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);
     figure (108)

     subplot(2,2,1)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.Mf,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'Mf [kg]'</span>);

     subplot(2,2,2)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.Mf,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'Mf [kg]'</span>);

     subplot(2,2,3)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.PL,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'PL [N]'</span>);

     subplot(2,2,4)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.PL,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'PL [N]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_08.png" alt=""> <pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);
     figure (109)

     subplot(2,2,1)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.V,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'V [m/s]'</span>);

     subplot(2,2,2)
     grid <span class="string">on</span>
     x = missState.mSeg{s}.T;
     y = missState.mSeg{s}.R;
     plot(x,y,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     ylabel(<span class="string">'R [m]'</span>);
     xlabel(<span class="string">'T [s]'</span>);

     subplot(2,2,3)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.H,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'H [m]'</span>);

     subplot(2,2,4)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.P/10^3,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'P [kW]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_09.png" alt=""> <p><b>Fixing the maximum time of extinction:</b></p><p>In this other case, the extinction time is fixed for two hours and in this way the segments are fixed with this constrain too.</p><p>First we setup heroes environment, a helicopter and the initial payload and fuel mass and the fuel reserve:</p><pre class="codeinput">atm    = getISA;
he     = ec135e(atm);
OmegaN =  he.mainRotor.Omega;

PL0  = 180*atm.g;
Mf0  = 300;
RF   = 65;
</pre><p>It is also necessary to setup the maximum allowed time for the fire extinction, specified by the regulations of the country.</p><pre class="codeinput">Tmax = 7200;
</pre><p>Now the maximum number of possible refills for this specified time is calculated. To do that, it is necessary to calculate the time employed to perform the water refilling  and fire fighting segments.</p><p>The segments involved in the filling and discharge of water for the extinction are:</p><p><b>DescentSegment</b>     for approaching the sea, lake or dam. <b>HoverSegment</b>       for refilling water. <b>ClimbSegment</b>       for ascending at flight hight. <b>CruiseRangeSegment</b> for reaching the fire area. <b>DescentSegment</b>     for approaching the fire area. <b>CruiseRangeCruise</b>  for discharging the water. <b>ClimbSegment</b>       for ascending at flight hight. <b>CruiseRangeSegment</b> for returning to the sea, lake or dam.</p><pre class="codeinput">extinctionPlan = {<span class="keyword">...</span><span class="comment"> Route heliport - area of water</span>
                  @(pos)HoverSegmentBuilder(pos,60,0,OmegaN),<span class="keyword">...</span>
                  @(pos)MinFuelClimb4VSegmentBuilder(pos,550,40,0,OmegaN),<span class="keyword">...</span>
                  @(pos)BestCruiseRangeSegmentBuilder(pos,10^4,0,OmegaN),<span class="keyword">...</span>
                  <span class="keyword">...</span><span class="comment"> Extinction plan</span>
                  @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),<span class="keyword">...</span>
                  @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),<span class="keyword">...</span>
                  @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),<span class="keyword">...</span>
                  @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),<span class="keyword">...</span>
                  @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),<span class="keyword">...</span>
                  @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),<span class="keyword">...</span>
                  @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),<span class="keyword">...</span>
                  @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN)};
</pre><p>Remember that a list of all possible segments, as well as all the requested help for building helicopter missions can be found by typing on cosole:</p><pre>     &gt;&gt; help mission</pre><pre class="codeinput">[MfBurntExt,missStateExt] = getMissionState(he,atm,extinctionPlan,PL0,Mf0,RF);

iniTime2Water  = missStateExt.mSeg{1}.DT + missStateExt.mSeg{2}.DT + <span class="keyword">...</span>
                 missStateExt.mSeg{3}.DT + missStateExt.mSeg{4}.DT;

extinctionTime = missStateExt.mSeg{5}.DT  + missStateExt.mSeg{6}.DT + <span class="keyword">...</span>
                 missStateExt.mSeg{7}.DT  + missStateExt.mSeg{8}.DT + <span class="keyword">...</span>
                 missStateExt.mSeg{9}.DT  + missStateExt.mSeg{10}.DT + <span class="keyword">...</span>
                 missStateExt.mSeg{11}.DT + missStateExt.mSeg{12}.DT ;
</pre><pre class="codeoutput">
Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1
</pre><p>Calculating the possible extinctions number:</p><pre class="codeinput">extinctionsNumber = floor ( (Tmax - iniTime2Water) / extinctionTime );

disp(<span class="string">'Civil Firefighting Mission'</span>);

formatSpec = <span class="string">'The Extinctions Number is %d.'</span>;
G      = extinctionsNumber;
extNum = sprintf(formatSpec,G);
disp(extNum);
</pre><pre class="codeoutput">Civil Firefighting Mission
The Extinctions Number is 5.
</pre><p>Once the extinction number is calculated, it is possible to define the entire mission.</p><pre class="codeinput">mission = {<span class="keyword">...</span><span class="comment"> Route heliport - area of water</span>
           @(pos)HoverSegmentBuilder(pos,60,0,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,550,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,10^4,0,OmegaN),<span class="keyword">...</span>
           <span class="keyword">...</span><span class="comment"> 1 refill and discharge of water</span>
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),<span class="keyword">...</span>
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN),<span class="keyword">...</span>
           <span class="keyword">...</span><span class="comment"> 2 refill and discharge of water</span>
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),<span class="keyword">...</span>
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN),<span class="keyword">...</span>
           <span class="keyword">...</span><span class="comment"> 3 refill and discharge of water</span>
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),<span class="keyword">...</span>
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN),<span class="keyword">...</span>
           <span class="keyword">...</span><span class="comment"> 4 refill and discharge of water</span>
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),<span class="keyword">...</span>
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN),<span class="keyword">...</span>
           <span class="keyword">...</span><span class="comment"> 5 refill and discharge of water</span>
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),<span class="keyword">...</span>
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),<span class="keyword">...</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),<span class="keyword">...</span>
           <span class="keyword">...</span><span class="comment"> Back to the heliport</span>
           @(pos)MinFuelClimb4VSegmentBuilder(pos,650,40,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestCruiseRangeSegmentBuilder(pos,7.73*10^4,0,OmegaN),<span class="keyword">...</span>
           @(pos)BestGlideSegmentBuilder(pos,-750,0,OmegaN),<span class="keyword">...</span>
           @(pos)TaxiSegmentBuilder(pos,72,4,0,OmegaN)};
</pre><p>Solving the mission:</p><pre class="codeinput">[MfBurnt,missState] = getMissionState(he,atm,mission,PL0,Mf0,RF);

formatSpec = <span class="string">'The fuel mass consumed is %d.'</span>;
I    = MfBurnt;
MfB3 = sprintf(formatSpec,I);
disp(MfB3);
</pre><pre class="codeoutput">
Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.
The fuel mass consumed is 2.797766e+02.
</pre><p>It is possible to check that the maximum extinction time is according to the regulations and that it is not possible to do one more extinction section because the maximum time of extinction would be exceeded.</p><pre class="codeinput">tExtTotal  = (missState.mSeg{43}.T(2));
formatSpec = <span class="string">'The total extinction time is %d.'</span>;
K      = tExtTotal;
TextTot = sprintf(formatSpec,K);
disp(TextTot);

tRefill    = (missState.mSeg{12}.T(2)-missState.mSeg{4}.T(2));
formatSpec = <span class="string">'The time of each refill and discharge of water is %d.'</span>;
L    = tRefill;
Tref = sprintf(formatSpec,L);
disp(Tref);

formatSpec = <span class="string">'The total extinction time, adding another section extinction is %d.'</span>;
M     = tExtTotal + tRefill;
T6ext = sprintf(formatSpec,M);
disp(T6ext);
</pre><pre class="codeoutput">The total extinction time is 6.251650e+03.
The time of each refill and discharge of water is 1.319885e+03.
The total extinction time, adding another section extinction is 7.571535e+03.
</pre><p>Optimizing the initial fuel mass:</p><pre class="codeinput">Mf0opt = getOptimumFuelMass(he,atm,mission,PL0,Mf0,RF);

formatSpec = <span class="string">'The optimum fuel mass is %d.'</span>;
J    = Mf0opt;
MfO3 = sprintf(formatSpec,J);
disp(MfO3);
</pre><pre class="codeoutput">
Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum possible. Constraints satisfied.

fmincon stopped because the size of the current search direction is less than
twice the default value of the step size tolerance and constraints are 
satisfied to within the default value of the constraint tolerance.



No active inequalities.

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1

Local minimum found that satisfies the constraints.

Optimization completed because the objective function is non-decreasing in 
feasible directions, to within the default value of the function tolerance,
and constraints are satisfied to within the default value of the constraint tolerance.



Active inequalities (to within options.TolCon = 1e-06):
  lower      upper     ineqlin   ineqnonlin
                                     1
The optimum fuel mass is 2.785230e+02.
</pre><p>Finally some plots to see the final state of the mission.</p><pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);

     figure (110)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.H,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'H [m]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_10.png" alt=""> <pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);
     figure (111)

     subplot(2,2,1)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.Mf,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'Mf [kg]'</span>);

     subplot(2,2,2)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.Mf,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'Mf [kg]'</span>);

     subplot(2,2,3)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.R,missState.mSeg{s}.PL,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'R [m]'</span>);
     ylabel(<span class="string">'PL [N]'</span>);

     subplot(2,2,4)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.PL,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'PL [N]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_11.png" alt=""> <pre class="codeinput"><span class="keyword">for</span> s = 1:length(missState.mSeg);
     figure (112)

     subplot(2,2,1)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.V,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'V [m/s]'</span>);

     subplot(2,2,2)
     grid <span class="string">on</span>
     x = missState.mSeg{s}.T;
     y = missState.mSeg{s}.R;
     plot(x,y,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     ylabel(<span class="string">'R [m]'</span>);
     xlabel(<span class="string">'T [s]'</span>);

     subplot(2,2,3)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.H,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'H [m]'</span>);

     subplot(2,2,4)
     grid <span class="string">on</span>
     plot(missState.mSeg{s}.T,missState.mSeg{s}.P/10^3,<span class="string">'o-'</span>);
     hold <span class="string">on</span>
     xlabel(<span class="string">'T [s]'</span>);
     ylabel(<span class="string">'P [kW]'</span>);

<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="demoHelicopterMissions_12.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%% Helicopter missions
%
% This demo shows the usage of mission module to help in the construction 
% of helicopters missions. 
% 
%
%% Introduction 
%
% The term _*mission*_ refers to the intended use of the aircraft and 
% determines its design since it specifies what is required in the usage 
% of the helicopter. These requirements are used in the design chain to 
% evaluate the quality and need to be studied in order to check if a 
% helicopter is able to carry out what is entrusted.
%
% Mission is a set of flight segments that need to be executed under agreed 
% conditions. The choice of flight variables included in these segments 
% must be consistent with what the mission requires and therefore being 
% able to calculate all that is needed. A mission involves burning fuel 
% during its performance, so it is necessary to consider modifying the mass 
% conditions along it.
% 
% To verify the performance of a task by a helicopter, it is required to 
% develop the tools to configure this mission. To do this, it will proceed 
% first by defining the elements forming a mission.
%
%
close all
setPlot

%% Description of usage
%
% The example chosen to assist the usage of this module, mission, is that 
% of a simple mission formed by a pair of segments. It is displayed below:
%
%%
% First we always have to set up heroes environment by defining an ISA+0 
% atmosphere and a Eurocopter EC135 helicopter. The variable _*atm*_ stores 
% the atmosphere, _*he*_ stores the helicopter and _*OmegaN*_ saves  the
% main rotor angular speed of the helicopter setup.

atm    = getISA;
he     = ec135e(atm);
OmegaN = he.mainRotor.Omega;

%%
% Then, the payload, the initial fuel mass and the fuel reserve are set up.
% It is important to remember that the payload dimensions are _[N]_, and 
% the dimensions of fuel mass and fuel reserve are _[Kg]_.
%
% The Reserve of fuel must be set according to the regulations:
% In the case of VFR operations, the regulations establish that the fuel 
% reserves should be enough to fly for 20 minutes at maximum speed range. 
% While in the case of IFR, fuel reserve must be sufficient to fly for 
% 30 minutes at hover speed at 450 m (1500 ft) above the aerodrome of 
% destination.

PL0 = 150*atm.g;
Mf0 = 100;
RF  = 65;

%%
% Once the mission requirements have been loaded, it is necessary to define
% the type of mission to be performed by the selected helicopter, in this 
% case the Eurocopter EC135.
% Each segment needs several inputs, being the first, last and penultimate 
% entries common for all segment builders. These three inputs correspond 
% respectively to the segment position, the main rotor angular speed and 
% payload variation of the flight segment. The other inputs are different
% for each segment and match with for example, the hight variation of the 
% flight segment, ascent or descent angle, the time increment of the flight 
% segment and other variables. The help of each segment builder explains 
% all the inputs needed for this segment.

mission = {@(pos)TaxiSegmentBuilder(pos,120,4,0,OmegaN),...
           @(pos)ClimbSegmentBuilder(pos,580,36,5*pi/180,0,OmegaN)};
%%
% A list of all possible segments, as well as all the requested help for 
% building helicopter missions can be found by typing on cosole:
% 
%       >> help mission
%
%%
% Next step, after defining the required mission, is to solve the whole 
% mission using _*getMissionState*_. This function saves the results of the 
% mission in two variables, _*MfBurnt*_ and _*missState*_.
%
% * _*MfBurnt*_ stores the fuel mass consumed during the mission, which has 
% been obtained with the given initial parameters.
%
% * _*missState*_ saves the mission segments parameters. 
%
% The help of this function explains how these variables are, which the 
% saved parameters are and how to use the function.
%
% In order to calculate the mission, this function includes a dummy hover
% segment which is common for all the missions. That is why, in _*missState*_
% this dummy hover segment is the first saved and then saves the rest of 
% them. So the final number of segments is, in this case, three.
%

[MfBurnt,missState] = getMissionState(he,atm,mission,PL0,Mf0,RF);

%%
% Finally, this module aims to optimize the fuel mass that the helicopter 
% should carry to complete the mission without problems and with zero fuel 
% mass at the end. This optimization is carried out with the function
% _*getOptimumFuelMass*_ and the optimum initial fuel mass obtained is kept 
% in the variable _*Mf0opt*_.
%

Mf0opt = getOptimumFuelMass(he,atm,mission,PL0,Mf0,RF);

%%
% After obtaining the results of the mission, it is useful plotting these 
% results to see what is the mission state and to check if it was 
% successful.
%
% The most representative plot of the mission route is the hight versus
% the range.
%

for s = 1:length(missState.mSeg);
     
     figure (100)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.H,'o-');
     hold on
     xlabel('R [m]');
     ylabel('H [m]');
                
end

%%
% Another representative plot of the mission parameters is the fuel mass
% variation and the payload variation with range and time
 
for s = 1:length(missState.mSeg);
     
     figure (102)
     
     subplot(2,2,1)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.Mf,'o-');
     hold on
     xlabel('R [m]');
     ylabel('Mf [kg]');
     
     subplot(2,2,2)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.Mf,'o-');
     hold on
     xlabel('T [s]');
     ylabel('Mf [kg]');
     
     subplot(2,2,3)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.PL,'o-');
     hold on
     xlabel('R [m]');
     ylabel('PL [N]');
     
     subplot(2,2,4)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.PL,'o-');
     hold on
     xlabel('T [s]');
     ylabel('PL [N]');
    
end

%%
% At the end, other important plots could be the following:

for s = 1:length(missState.mSeg);
     
     figure (103)
     
     subplot(2,2,1)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.V,'o-');
     hold on
     xlabel('T [s]');
     ylabel('V [m/s]');
     
     subplot(2,2,2)
     grid on
     x = missState.mSeg{s}.T;
     y = missState.mSeg{s}.R;
     plot(x,y,'o-');
     hold on
     ylabel('R [m]');
     xlabel('T [s]');
     
     subplot(2,2,3)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.H,'o-');
     hold on
     xlabel('T [s]');
     ylabel('H [m]');
     
     subplot(2,2,4)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.P/10^3,'o-');
     hold on
     xlabel('T [s]');
     ylabel('P [kW]');
              
end


%% Example of a simple mission type: Civil Surveillance Mission
%
% One of the easiest helicopter missions is the *Civil Surveillance*
% *Mission*. This mission type has seven segments, without counting the 
% dummy segment, in which a cruise speed of maximum endurance is included. 
% The reason of this type of cruise segment is that the aim of the mission 
% consists on surveilling an area for the maximum, possible time. After 
% this cruise, there is a hover flight segment to focuse on the main area 
% of the surveillance. 
%
%%
% First we setup heroes environment by defining an ISA+0 atmosphere and a 
% Eurocopter EC135 helicopter. The variable _*atm*_ stores the atmosphere, 
% _*he*_ stores the helicopter and _*OmegaN*_ saves the main rotor angular 
% speed.

atm    = getISA;
he     = ec135e(atm);
OmegaN = he.mainRotor.Omega;

%%
% Then the payload, the initial fuel mass and the fuel reserve are setup.
% Remember that the payload dimensions are _[N]_, and the dimensions of 
% fuel mass and reserve of fuel are _[Kg]_.
%

PL0 = 150*atm.g;
Mf0 = 120;
RF  = 65;

%%
% In this type of mission the payload variation is zero, all necessary 
% payload is set up at the begining of the mission and it is not variable 
% through the mission.
%
%% 
% Now, we have to define the mission segments:
%
% First, there is a _*HOVER*_ segment which will be defined by the time 
% increment, DT, and like all segments, by payload variation and the main
% rotor angular speed. The second is a _*TAXI*_ segment, it is defined by
% time increment, DT, and flight velocity, DV. For defining the third
% segment, _*CLIMB*_, we have as inputs hight increment,DH, the flight
% velocity, DV, and the ascent angle, gammaT. The fourth segment is a
% _*CRUISE*_, which is defined only by time increment, DT, because this
% segment is calculated with the maximum endurance velocity. The fifth
% mission segment is a _*HOVER*_, defined as in the previous case. Finally,
% the mission has a _*DESCENT*_ segment defined as a climb segment but with
% negative angle and negative hight increment, and a _*TAXI*_ segment 
% defined as in the previous case.
%

mission = {@(pos)HoverSegmentBuilder(pos,60,0,OmegaN),...
           @(pos)TaxiSegmentBuilder(pos,90,4,0,OmegaN),...
           @(pos)ClimbSegmentBuilder(pos,650,30,15*pi/180,0,OmegaN),...
           @(pos)BestCruiseTimeSegmentBuilder(pos,3600,0,OmegaN),...
           @(pos)HoverSegmentBuilder(pos,180,0,OmegaN),...
           @(pos)DescentSegmentBuilder(pos,-650,30,-15*pi/180,0,OmegaN),...
           @(pos)TaxiSegmentBuilder(pos,90,4,0,OmegaN)};
%%
% Remember that a list of all possible segments, as well as all the 
% requested help for building helicopter missions can be found by typing 
% on cosole:
% 
%       >> help mission
%
%%
% In this moment we are ready to solve the mission:
%

[MfBurnt,missState] = getMissionState(he,atm,mission,PL0,Mf0,RF);

disp('Civil Surveillance Mission')
formatSpec = 'The consumed fuel mass is %d.';
A    = MfBurnt;
MfB1 = sprintf(formatSpec,A);
disp(MfB1);

%%
% Once the fuel mass consumption and mission state are obtained, we can
% optimize the initial fuel mass to carry out the mission without problem,
% with the minimum initial fuel masss possible.
%

Mf0opt = getOptimumFuelMass(he,atm,mission,PL0,Mf0,RF);

formatSpec = 'The optimum fuel mass is %d.';
B    = Mf0opt;
MfO1 = sprintf(formatSpec,B);
disp(MfO1);

%%
% Sometimes it may also be useful to print some mission data. For example
% the total mission time or the range the climb segment takes.
%
formatSpec = 'The total mission time is %d.';
C  = missState.mSeg{8}.T(2);
C1 = sprintf(formatSpec,C);
disp(C1);

formatSpec = 'The range the climb segment takes is %d.';
D  = missState.mSeg{4}.DR;
D1 = sprintf(formatSpec,D);
disp(D1);

%%
% Finally we can plot some mission parameters to see the mission final
% state.

for s = 1:length(missState.mSeg);
     
     figure (104)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.H,'o-');
     hold on
     xlabel('R [m]');
     ylabel('H [m]');
      
end

%%
for s = 1:length(missState.mSeg); 
     figure (105)
     
     subplot(2,2,1)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.Mf,'o-');
     hold on
     xlabel('R [m]');
     ylabel('Mf [kg]');
     
     subplot(2,2,2)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.Mf,'o-');
     hold on
     xlabel('T [s]');
     ylabel('Mf [kg]');
     
     subplot(2,2,3)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.PL,'o-');
     hold on
     xlabel('R [m]');
     ylabel('PL [N]');
     
     subplot(2,2,4)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.PL,'o-');
     hold on
     xlabel('T [s]');
     ylabel('PL [N]');
     
end

%%
for s = 1:length(missState.mSeg);
     figure (106)
     
     subplot(2,2,1)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.V,'o-');
     hold on
     xlabel('T [s]');
     ylabel('V [m/s]');
     
     subplot(2,2,2)
     grid on
     x = missState.mSeg{s}.T;
     y = missState.mSeg{s}.R;
     plot(x,y,'o-');
     hold on
     ylabel('R [m]');
     xlabel('T [s]');
     
     subplot(2,2,3)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.H,'o-');
     hold on
     xlabel('T [s]');
     ylabel('H [m]');
     
     subplot(2,2,4)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.P/10^3,'o-');
     hold on
     xlabel('T [s]');
     ylabel('P [kW]');
     
end

%% Example of a complex mission type: Civil Firefighting Mission
%
% In firefighting mission,it is difficult to define the segments 
% compounding this mission because the refill segments for the complete 
% extinction of fire are not defined. 
% The time a helicopter can be extinguishing a fire is regulated, and 
% usually it is set to two hours. So there are two possible ways to set the 
% refill and extinction mission segments.
%
% * Fixing a number of segments
%
% * Fixing the maximum time of extinction
%
%%
% *Fixing number of segments:*
%
% In this case, the number of water refills must be fixed at first. Since 
% the extinction time is limited for two hours, once the mission is 
% calculated you should check if this constraint is satisfied by the number 
% of segments that had been planned for the mission.
% 
% Example of usage:
% 
% First we setup heroes environment, a helicopter and the initial payload 
% and fuel mass and the fuel reserve:
% 

atm    = getISA;
he     = ec135e(atm);
OmegaN = he.mainRotor.Omega;

PL0 = 150*atm.g;
Mf0 = 130;
RF  = 65;

%%
% Setting the mission segments. 
% 
% *Refills number: 1* Segments involved in the extinction of fire must be
% repeated as much times as refills number.
%
% The segments involved in the filling and discharge of water for the 
% extinction are:
%
% *DescentSegment*     for approaching the sea, lake or dam.
% *HoverSegment*       for refilling water.
% *ClimbSegment*       for ascending at flight hight.
% *CruiseRangeSegment* for reaching the fire area.
% *DescentSegment*     for approaching the fire area.
% *CruiseRangeCruise*  for discharging the water.
% *ClimbSegment*       for ascending at flight hight.
% *CruiseRangeSegment* for returning to the sea, lake or dam.
%
% In such a mission, payload variation must be considered due to the charge 
% and discharge of water.

mission = {... Route heliport - area of water
           @(pos)HoverSegmentBuilder(pos,60,0,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,300,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,4*10^4,0,OmegaN),...
           ... 1 refill and discharge of water
           @(pos)BestGlideSegmentBuilder(pos,-280,0,OmegaN),...
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,280,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),...
           @(pos)BestGlideSegmentBuilder(pos,-200,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),...
           ... Back to the heliport
           @(pos)MinFuelClimb4VSegmentBuilder(pos,380,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,71*10^3,0,OmegaN),...
           @(pos)BestGlideSegmentBuilder(pos,-480,0,OmegaN),...
           @(pos)TaxiSegmentBuilder(pos,72,4,0,OmegaN)};
       
%%
% Remember that a list of all possible segments, as well as all the 
% requested help for building helicopter missions can be found by typing 
% on cosole:
% 
%       >> help mission
%
%%
% Solving the mission and optimizing initial fuel mass:
%

[MfBurnt,missState] = getMissionState(he,atm,mission,PL0,Mf0,RF);

disp('Civil Firefighting Mission')
formatSpec = 'The consumed fuel mass is %d.';
E    = MfBurnt;
MfB2 = sprintf(formatSpec,E);
disp(MfB2);


Mf0opt = getOptimumFuelMass(he,atm,mission,PL0,Mf0,RF);

formatSpec = 'The optimum fuel mass is %d.';
F    = Mf0opt;
MfO2 = sprintf(formatSpec,F);
disp(MfO2);

%%
% Finally some plots to see the final state of the mission.

for s = 1:length(missState.mSeg);
     
     figure (107)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.H,'o-');
     hold on
     xlabel('R [m]');
     ylabel('H [m]');
      
end

%%
for s = 1:length(missState.mSeg); 
     figure (108)
     
     subplot(2,2,1)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.Mf,'o-');
     hold on
     xlabel('R [m]');
     ylabel('Mf [kg]');
     
     subplot(2,2,2)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.Mf,'o-');
     hold on
     xlabel('T [s]');
     ylabel('Mf [kg]');
     
     subplot(2,2,3)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.PL,'o-');
     hold on
     xlabel('R [m]');
     ylabel('PL [N]');
     
     subplot(2,2,4)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.PL,'o-');
     hold on
     xlabel('T [s]');
     ylabel('PL [N]');
     
end

%%
for s = 1:length(missState.mSeg);
     figure (109)
     
     subplot(2,2,1)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.V,'o-');
     hold on
     xlabel('T [s]');
     ylabel('V [m/s]');
     
     subplot(2,2,2)
     grid on
     x = missState.mSeg{s}.T;
     y = missState.mSeg{s}.R;
     plot(x,y,'o-');
     hold on
     ylabel('R [m]');
     xlabel('T [s]');
     
     subplot(2,2,3)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.H,'o-');
     hold on
     xlabel('T [s]');
     ylabel('H [m]');
     
     subplot(2,2,4)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.P/10^3,'o-');
     hold on
     xlabel('T [s]');
     ylabel('P [kW]');
     
end

%%
% *Fixing the maximum time of extinction:*
%
% In this other case, the extinction time is fixed for two hours and in
% this way the segments are fixed with this constrain too.
% 
% First we setup heroes environment, a helicopter and the initial payload 
% and fuel mass and the fuel reserve:
%

atm    = getISA;
he     = ec135e(atm);
OmegaN =  he.mainRotor.Omega;

PL0  = 180*atm.g;
Mf0  = 300;
RF   = 65;
%%
% It is also necessary to setup the maximum allowed time for the
% fire extinction, specified by the regulations of the country.

Tmax = 7200;

%%
% Now the maximum number of possible refills for this specified time is
% calculated. To do that, it is necessary to calculate the time employed 
% to perform the water refilling  and fire fighting segments.
%
% The segments involved in the filling and discharge of water for the 
% extinction are:
%
% *DescentSegment*     for approaching the sea, lake or dam.
% *HoverSegment*       for refilling water.
% *ClimbSegment*       for ascending at flight hight.
% *CruiseRangeSegment* for reaching the fire area.
% *DescentSegment*     for approaching the fire area.
% *CruiseRangeCruise*  for discharging the water.
% *ClimbSegment*       for ascending at flight hight.
% *CruiseRangeSegment* for returning to the sea, lake or dam.
%

extinctionPlan = {... Route heliport - area of water
                  @(pos)HoverSegmentBuilder(pos,60,0,OmegaN),...
                  @(pos)MinFuelClimb4VSegmentBuilder(pos,550,40,0,OmegaN),...
                  @(pos)BestCruiseRangeSegmentBuilder(pos,10^4,0,OmegaN),...
                  ... Extinction plan 
                  @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),...
                  @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),...
                  @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),...
                  @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),...
                  @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),...
                  @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),...
                  @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),...
                  @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN)};

%%
% Remember that a list of all possible segments, as well as all the 
% requested help for building helicopter missions can be found by typing 
% on cosole:
% 
%       >> help mission
%

[MfBurntExt,missStateExt] = getMissionState(he,atm,extinctionPlan,PL0,Mf0,RF);

iniTime2Water  = missStateExt.mSeg{1}.DT + missStateExt.mSeg{2}.DT + ...
                 missStateExt.mSeg{3}.DT + missStateExt.mSeg{4}.DT;

extinctionTime = missStateExt.mSeg{5}.DT  + missStateExt.mSeg{6}.DT + ...
                 missStateExt.mSeg{7}.DT  + missStateExt.mSeg{8}.DT + ...
                 missStateExt.mSeg{9}.DT  + missStateExt.mSeg{10}.DT + ...
                 missStateExt.mSeg{11}.DT + missStateExt.mSeg{12}.DT ;
             
%%
% Calculating the possible extinctions number:

extinctionsNumber = floor ( (Tmax - iniTime2Water) / extinctionTime );

disp('Civil Firefighting Mission');

formatSpec = 'The Extinctions Number is %d.';
G      = extinctionsNumber;
extNum = sprintf(formatSpec,G);
disp(extNum);

%%
% Once the extinction number is calculated, it is possible to define the
% entire mission.
%
mission = {... Route heliport - area of water 
           @(pos)HoverSegmentBuilder(pos,60,0,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,550,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,10^4,0,OmegaN),...
           ... 1 refill and discharge of water
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),...
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),...
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN),...
           ... 2 refill and discharge of water
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),...
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),...
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN),...
           ... 3 refill and discharge of water
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),...
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),...
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN),...
           ... 4 refill and discharge of water
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),...
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),...
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,450,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3.6*10^4,0,OmegaN),...
           ... 5 refill and discharge of water
           @(pos)BestGlideSegmentBuilder(pos,-540,0,OmegaN),...
           @(pos)HoverSegmentBuilder(pos,30,10^4,OmegaN),...
           @(pos)MinFuelClimb4VSegmentBuilder(pos,540,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,3*10^4,0,OmegaN),...
           @(pos)BestGlideSegmentBuilder(pos,-450,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,1000,-10^4,OmegaN),...
           ... Back to the heliport
           @(pos)MinFuelClimb4VSegmentBuilder(pos,650,40,0,OmegaN),...
           @(pos)BestCruiseRangeSegmentBuilder(pos,7.73*10^4,0,OmegaN),...
           @(pos)BestGlideSegmentBuilder(pos,-750,0,OmegaN),...
           @(pos)TaxiSegmentBuilder(pos,72,4,0,OmegaN)};
       
%%
% Solving the mission:
%
[MfBurnt,missState] = getMissionState(he,atm,mission,PL0,Mf0,RF);

formatSpec = 'The fuel mass consumed is %d.';
I    = MfBurnt;
MfB3 = sprintf(formatSpec,I);
disp(MfB3);

%% 
% It is possible to check that the maximum extinction time is according to
% the regulations and that it is not possible to do one more extinction 
% section because the maximum time of extinction would be exceeded.
%
tExtTotal  = (missState.mSeg{43}.T(2));
formatSpec = 'The total extinction time is %d.';
K      = tExtTotal;
TextTot = sprintf(formatSpec,K);
disp(TextTot);

tRefill    = (missState.mSeg{12}.T(2)-missState.mSeg{4}.T(2));
formatSpec = 'The time of each refill and discharge of water is %d.';
L    = tRefill;
Tref = sprintf(formatSpec,L);
disp(Tref);

formatSpec = 'The total extinction time, adding another section extinction is %d.';
M     = tExtTotal + tRefill;
T6ext = sprintf(formatSpec,M);
disp(T6ext);

%%
% Optimizing the initial fuel mass:
%

Mf0opt = getOptimumFuelMass(he,atm,mission,PL0,Mf0,RF);

formatSpec = 'The optimum fuel mass is %d.';
J    = Mf0opt;
MfO3 = sprintf(formatSpec,J);
disp(MfO3);

%%
% Finally some plots to see the final state of the mission.

for s = 1:length(missState.mSeg);
     
     figure (110)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.H,'o-');
     hold on
     xlabel('R [m]');
     ylabel('H [m]');
      
end

%%
for s = 1:length(missState.mSeg); 
     figure (111)
     
     subplot(2,2,1)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.Mf,'o-');
     hold on
     xlabel('R [m]');
     ylabel('Mf [kg]');
     
     subplot(2,2,2)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.Mf,'o-');
     hold on
     xlabel('T [s]');
     ylabel('Mf [kg]');
     
     subplot(2,2,3)
     grid on
     plot(missState.mSeg{s}.R,missState.mSeg{s}.PL,'o-');
     hold on
     xlabel('R [m]');
     ylabel('PL [N]');
     
     subplot(2,2,4)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.PL,'o-');
     hold on
     xlabel('T [s]');
     ylabel('PL [N]');
     
end

%%
for s = 1:length(missState.mSeg);
     figure (112)
     
     subplot(2,2,1)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.V,'o-');
     hold on
     xlabel('T [s]');
     ylabel('V [m/s]');
     
     subplot(2,2,2)
     grid on
     x = missState.mSeg{s}.T;
     y = missState.mSeg{s}.R;
     plot(x,y,'o-');
     hold on
     ylabel('R [m]');
     xlabel('T [s]');
     
     subplot(2,2,3)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.H,'o-');
     hold on
     xlabel('T [s]');
     ylabel('H [m]');
     
     subplot(2,2,4)
     grid on
     plot(missState.mSeg{s}.T,missState.mSeg{s}.P/10^3,'o-');
     hold on
     xlabel('T [s]');
     ylabel('P [kW]');
     
end

##### SOURCE END #####
--></body></html>